[flake8]
ignore = E122,E125,E128,E251,E501,E701,E704,E721,E741,W293,W503,W504,W605,F405,E203
exclude =
    htmlcov
    *coverage*
    *tests*
    ci_config
    .venv
    .envs
    .compose
    k8s
    logs
    locale
    alembic
    *entrypoint*

[mypy]
# Исключить каталоги из проверки
exclude =
    htmlcov
    *coverage*
    *tests*
    ci_config
    .venv
    .envs
    .compose
    k8s
    logs
    locale

# Включить строгие проверки типов
strict = True

# Показывать полные сообщения об ошибках
show_error_codes = True
pretty = True

# Проверять отсутствие аннотаций у функций
disallow_untyped_defs = True

# Запретить использование `Any` без явного указания
disallow_any_unimported = False
disallow_any_expr = False

# Требовать аннотации типов переменных
disallow_untyped_calls = True
disallow_untyped_decorators = False

# Проверка возвратов функций
check_untyped_defs = False

# Предупреждать, если в модулях нет type hints
warn_unused_ignores = True
warn_return_any = False
warn_unreachable = True

# Игнорировать ошибки импорта
ignore_missing_imports = True

# Игнорировать ошибки типов аргументов
disable_error_code = arg-type, type-arg, no-untyped-def, no-untyped-call, misc, union-attr


[pytest]
asyncio_mode = auto
testpaths = src/tests
python_files = test_*.py
python_classes = Test*
python_functions = test_*

markers =
    unit: marks tests as unit tests (deselect with '-m "not unit"')
    integration: marks tests as integration tests (deselect with '-m "not integration"')
    api: marks tests as API tests
    service: marks tests as service tests

addopts =
    --verbose
    -xvs

env =
    KEYCLOAK_BASE_URL=http://localhost:8080
    KEYCLOAK_REALM_NAME=master
    KEYCLOAK_CLIENT_ID=dummy-client-id
    KEYCLOAK_CLIENT_SECRET=dummy_secret
    KEYCLOAK_REALM_ADMIN_USERNAME=admin
    KEYCLOAK_REALM_ADMIN_PASSWORD=admin_password

asyncio_default_fixture_loop_scope = function